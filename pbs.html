
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport"
          content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Document</title>
</head>
<body>
<script src="prebid4.15.0.js"></script>
<script>
    var publisherId = 42939;
    pbjs.setConfig({
        s2sConfig: {
            accountId: '1',
            enabled: true,
            bidders: ['between'],
            timeout: 1000,
            adapter: 'prebidServer',
            endpoint: '//pbs.egorskorokhodov.ru/openrtb2/auction',
            syncEndpoint: '//pbs.egorskorokhodov.ru/cookie_sync',
            syncUrlModifier: {
                'between': function(type, url, bidder) {
                    url += encodeURIComponent(`&bidder_id=${publisherId}`);
                    return url
                }
            },
        }
    });
    let sizes = [[240, 400]];
    var PREBID_TIMEOUT = 10000;
    var adUnits = [{
        code: 'ad_slot',
        sizes: sizes,
        mediaTypes: {
            banner: {
                sizes: sizes,
            }
        },
        bids: [
            {
                bidder: 'between',
                bid_id: '1111',
                params: {
                    host: 'lbs-ru1.ads',
                    publisher_id: publisherId.toString(),
                    tag_id: '3979084',
                    site_id: '609638',
                    bid_floor: '0.000003',
                    bid_floor_cur: 'USD',
                }
            }
        ]
    }];
    pbjs.addAdUnits(adUnits);
    pbjs.requestBids({
        bidsBackHandler: sendAdserverRequest
    });

    function sendAdserverRequest() {
        if (pbjs.adserverRequestSent) return;
        pbjs.adserverRequestSent = true;
        var params = pbjs.getAdserverTargetingForAdUnitCode('ad_slot');
        console.log(params);
        var iframe = document.getElementById('ad_slot');
        var iframeDoc = iframe.contentWindow.document;
        pbjs.renderAd(iframeDoc, 'between');
    }

    setTimeout(function () {
        sendAdserverRequest();
    }, PREBID_TIMEOUT);
</script>
<iframe id="ad_slot"></iframe>
<iframe src="https://ads.betweendigital.com/sspmatch-iframe" frameborder="0"></iframe>

Prebid.js testing page
</body>
</html>
